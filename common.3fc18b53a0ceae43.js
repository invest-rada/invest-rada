"use strict";(self.webpackChunkinvest_rada=self.webpackChunkinvest_rada||[]).push([[592],{2434:(H,Q,n)=>{n.d(Q,{E:()=>y});var e=n(655),R=n(5520),h=n(9594),f=n(1135),L=n(8505),x=n(9646),o=n(6814),p=n(1445);const K=(0,p.Z)("--cui-success")??"#4dbd74",k=(0,p.Z)("--cui-info")??"#20a8d8",w=((i,t=100)=>{if(typeof i>"u")throw new TypeError("Hex color is not defined");if(!i.match(/^#(?:[0-9a-f]{3}){1,2}$/i))throw new Error(`${i} is not a valid hex color`);let s,a,l;return 7===i.length?(s=parseInt(i.slice(1,3),16),a=parseInt(i.slice(3,5),16),l=parseInt(i.slice(5,7),16)):(s=parseInt(i.slice(1,2),16),a=parseInt(i.slice(2,3),16),l=parseInt(i.slice(3,5),16)),`rgba(${s}, ${a}, ${l}, ${t/100})`})((0,p.Z)("--cui-info"),10)??"#20a8d8",M=(0,p.Z)("--cui-danger")||"#f86c6b",V=[{backgroundColor:"transparent",borderColor:k,pointHoverBackgroundColor:k,borderWidth:2},{backgroundColor:"transparent",borderColor:K||"#4dbd74",pointHoverBackgroundColor:"#fff"},{borderColor:M||"#f86c6b",pointHoverBackgroundColor:M,borderWidth:2,borderDash:[8,5],backgroundColor:w,fill:!0}],Z={maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{labelColor:function(i){return{backgroundColor:i.dataset.borderColor}}}}},scales:{x:{grid:{drawOnChartArea:!1}},y:{beginAtZero:!0,ticks:{maxTicksLimit:5,stepSize:Math.ceil(50)}}},elements:{line:{tension:.4},point:{radius:0,hitRadius:10,hoverRadius:4,hoverBorderWidth:3}}};var C,B,c,g,d,m,S,b,I=n(226),U=n(9439),v=n(1571),W=n(4794),$=n(3941),E=n(9769);class y{constructor(t,r,s){this.brand=t,this.stocksData=r,this.userData=s,this.estimateList=[],this.mainChart={},C.set(this,new f.X([])),this.consList$=(0,e.Q_)(this,C,"f").asObservable(),B.set(this,new f.X([])),this.posList$=(0,e.Q_)(this,B,"f").asObservable(),c.set(this,{sector:[],company:[],analysis:[]}),g.set(this,""),d.set(this,""),m.set(this,new f.X(null)),this.targetStock$=(0,e.Q_)(this,m,"f").asObservable(),S.set(this,new f.X({})),b.set(this,new f.X({})),this.userOrientedDeltas$=(0,e.Q_)(this,b,"f").asObservable(),this.userOrientedDeltas$.subscribe(()=>{this.estimateList=this.userData.currentUserMetrics.map(a=>{const l=this.getMetricByKey(a.key),O=this.getUserOrientedDeltaValueByKey(a.key);return{color:this.getResultColorBasedOnDeltaPercent(O),name:l,value:O}}),(0,e.Q_)(this,C,"f").next(this.estimateList.filter(a=>a.value<=-30)),(0,e.Q_)(this,B,"f").next(this.estimateList.filter(a=>a.value>=30))})}get targetStock(){return(0,e.Q_)(this,m,"f").getValue()}set targetStock(t){(0,e.Q_)(this,m,"f").next(t)}get metricDeltas(){return(0,e.Q_)(this,S,"f").getValue()}set metricDeltas(t){(0,e.Q_)(this,S,"f").next(t)}get userOrientedDeltas(){return(0,e.Q_)(this,b,"f").getValue()}set userOrientedDeltas(t){(0,e.Q_)(this,b,"f").next(t)}get fundamentalKeys(){return I.I}get currentSector(){return(0,e.Q_)(this,d,"f")}get currentSymbol(){return(0,e.Q_)(this,g,"f")}get resultToBuy(){const t=this.mainChart.companyUserBasedData.reduce((r,s)=>r+s,0);return(0,R.Z)(t,2)}get verbalRecommendation(){const t=this.resultToBuy;return t<-100?"Not recommended!":t<-50?"Below than expected":t<50?"Same as sector":t<100?"Above than expected":"Recommended to buy!"}resetRobot(){(0,e.YH)(this,g,"","f"),(0,e.YH)(this,d,"","f"),this.metricDeltas={},this.userOrientedDeltas={}}getRadarLabels(){const t=[];for(let r in o.i3)t.push((0,h.Z)(o.i3,r));return t}getDirectionByKey(t){return o.LD[o.i3[t]]===o.wM.Positive?1:-1}getChartLabels(){const t=[];for(let r in o.i3)t.push((0,h.Z)(o.i3,r));return t}getMetricByKey(t){return o.i3[t]}getRadarUserData(){return this.userData.currentUserMetrics.map(t=>t.priority)}getRadarRecommendedData(){return U.x7.map(t=>t.priority)}getResultColorBasedOnDeltaPercent(t){return t<-50?"danger":t<50?"warning":"success"}changeCurrentCompanyBySymbol(t){const r=this.brand.getBrandBySymbol(t);return this.stocksData.getFundamentalBySymbol(t).pipe((0,L.b)({next:s=>{(0,e.YH)(this,g,(0,h.Z)(s,"Symbol"),"f"),(0,e.YH)(this,d,(0,h.Z)(s,"Sector"),"f");const a=this.stocksData.getSectorFundamentalBySector((0,e.Q_)(this,d,"f"));this.targetStock={brand:r,fundamental:s,sector:a},this.initDeltaBetweenSector(),this.initChartData()}}))}calculateMetricDeltaByKey(t){const r=+this.getCompanyValueByKey(t),s=+this.getSectorValueByKey(t),a=(0,R.Z)((r-s)/s*100,2);return s<0?-1*a:a}initDeltaBetweenSector(){this.fundamentalKeys.forEach(t=>{this.metricDeltas={...this.metricDeltas,[t]:this.calculateMetricDeltaByKey(t)}})}getColorBasedOnDeltaPercent(t){return t<-30?"danger":t<30?"warning":"success"}getCompanyValueByKey(t){return(0,h.Z)(this.targetStock,["fundamental",t],0)}calculateAnalysisByMetric(t){const l=this.getDeltaValueByKey(t.key)*o.Nn[t.priority]*(o.LD[o.i3[t.key]]===o.wM.Positive?1:-1);return this.userOrientedDeltas={...this.userOrientedDeltas,[t.key]:(0,R.Z)(l,3)},l}getSectorValueByKey(t){return(0,h.Z)(this.targetStock,["sector",t],0)}getDeltaValueByKey(t){return this.metricDeltas[t]}getUserOrientedDeltaValueByKey(t){return this.userOrientedDeltas[t]}resetChartData(){(0,e.YH)(this,c,{sector:[],company:[],analysis:[]},"f")}initChartData(){this.resetChartData(),this.userData.currentUserMetrics.forEach((t,r)=>{(0,e.Q_)(this,c,"f").sector.push(this.getSectorValueByKey(t.key)),(0,e.Q_)(this,c,"f").company.push(this.getCompanyValueByKey(t.key)),(0,e.Q_)(this,c,"f").analysis.push(this.calculateAnalysisByMetric(t))})}initMainChart(){this.mainChart.elements=this.userData.currentUserMetrics.length,this.mainChart.sectorData=(0,e.Q_)(this,c,"f").sector,this.mainChart.companyData=(0,e.Q_)(this,c,"f").company,this.mainChart.companyUserBasedData=(0,e.Q_)(this,c,"f").analysis;const r=[{data:this.mainChart.sectorData,label:"Sector",...V[0]},{data:this.mainChart.companyData,label:"Company",...V[1]},{data:this.mainChart.companyUserBasedData,label:"User Oriented",...V[2]}],s=this.getChartLabels(),a=Z;return this.mainChart.type="line",this.mainChart.options=a,this.mainChart.data={datasets:r,labels:s},(0,x.of)(this.mainChart)}}C=new WeakMap,B=new WeakMap,c=new WeakMap,g=new WeakMap,d=new WeakMap,m=new WeakMap,S=new WeakMap,b=new WeakMap,y.\u0275fac=function(t){return new(t||y)(v.LFG(W.g),v.LFG($.E),v.LFG(E.M))},y.\u0275prov=v.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"})}}]);